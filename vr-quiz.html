<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>VR Quiz with Birds</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <style>body{margin:0;overflow:hidden;}</style>
</head>
<body>
<a-scene>

  <!-- Assets -->
  <a-assets>
    <img id="forestBG" src="https://cdn.aframe.io/360-image-gallery-boilerplate/img/sechelt.jpg">
    <img id="bird" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/Feather_icon.svg/64px-Feather_icon.svg.png">
    <img id="butterfly" src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/09/Butterfly_icon.svg/64px-Butterfly_icon.svg.png">
    <img id="correctSign" src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/50/Yes_Check_Circle.svg/64px-Yes_Check_Circle.svg.png">
    <img id="wrongSign" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e0/X_mark.svg/64px-X_mark.svg.png">

    <!-- Sounds -->
    <audio id="forestSound" src="https://cdn.jsdelivr.net/gh/anars/blank-audio/1sec.mp3" preload="auto"></audio>
    <audio id="correctAudio" src="https://freesound.org/data/previews/320/320655_4939433-lq.mp3" preload="auto"></audio>
    <audio id="wrongAudio" src="https://freesound.org/data/previews/109/109662_945474-lq.mp3" preload="auto"></audio>
  </a-assets>

  <!-- Camera + cursor -->
  <a-entity camera look-controls position="0 1.6 0">
    <a-entity cursor="fuse:true; fuseTimeout:500"
              raycaster="objects:.clickable"
              position="0 0 -1"
              geometry="primitive:ring; radiusInner:0.02; radiusOuter:0.03"
              material="color: cyan; shader: flat"></a-entity>
  </a-entity>

  <!-- Sky background -->
  <a-sky src="#forestBG" color="#FFF"></a-sky>
  <a-entity sound="src:#forestSound; autoplay:true; loop:true; volume:0.2"></a-entity>

  <!-- Flying birds and butterflies -->
  <a-image src="#bird" position="-5 3 -10" scale="0.5 0.5 0.5" 
           animation="property: position; to:5 3 -10; dur:20000; dir: alternate; loop:true"></a-image>
  <a-image src="#butterfly" position="5 2 -8" scale="0.5 0.5 0.5" 
           animation="property: position; to:-5 2 -8; dur:15000; dir: alternate; loop:true"></a-image>

  <!-- Question -->
  <a-entity id="question" position="0 2.5 -3" text="value: ; align:center; width:5; color:#FFF;"></a-entity>

  <!-- Answer boxes -->
  <a-box id="option1" class="clickable" position="-3 1.2 -3" depth="0.2" height="0.5" width="1.8" color="#FFC107"></a-box>
  <a-text id="text1" value="" align="center" position="-3 1.2 -2.7" color="#000" width="2.5"></a-text>

  <a-box id="option2" class="clickable" position="0 1.2 -3" depth="0.2" height="0.5" width="1.8" color="#8BC34A"></a-box>
  <a-text id="text2" value="" align="center" position="0 1.2 -2.7" color="#000" width="2.5"></a-text>

  <a-box id="option3" class="clickable" position="3 1.2 -3" depth="0.2" height="0.5" width="1.8" color="#03A9F4"></a-box>
  <a-text id="text3" value="" align="center" position="3 1.2 -2.7" color="#000" width="2.5"></a-text>

  <!-- Correct/Wrong sign -->
  <a-image id="sign" src="" position="0 2 -3" scale="0.8 0.8 0.8" visible="false"></a-image>

  <!-- Score -->
  <a-entity id="score" position="0 3.2 -3" text="value: Score: 0; align:center; color:#FFF; width:4;"></a-entity>

  <!-- Replay -->
  <a-box id="replay" class="clickable" position="0 -1 -3" depth="0.2" height="0.5" width="2" color="#FF9800" visible="false"></a-box>
  <a-text id="replayText" value="Replay Quiz" align="center" position="0 -1 -2.7" color="#000" width="2.5" visible="false"></a-text>

  <!-- Sounds for answers -->
  <a-entity id="correctSound" sound="src: #correctAudio"></a-entity>
  <a-entity id="wrongSound" sound="src: #wrongAudio"></a-entity>

  <script>
    const quiz = [
      {q:"Which data type is 25?", options:["Text","Number","Color"], answer:1},
      {q:"Which data type is 'Blue'?", options:["Text","Number","Color"], answer:2},
      {q:"Which data type is 'Hello'?", options:["Text","Number","Sound"], answer:0},
      {q:"Which data type is 02:30 PM?", options:["Date","Time","Number"], answer:1},
      {q:"Which data type is 12/09/2025?", options:["Date","Color","Sound"], answer:0},
      {q:"Which data type is a YouTube clip?", options:["Text","Video","Number"], answer:1},
      {q:"Which data type is music playing?", options:["Number","Sound","Text"], answer:1}
    ];

    let current=0, score=0;
    const boxes=["option1","option2","option3"];
    const texts=["text1","text2","text3"];
    const sign=document.querySelector("#sign");

    function loadQuestion(index){
      const q=quiz[index];
      document.querySelector("#question").setAttribute("text","value",q.q);
      boxes.forEach((id,i)=>{
        document.querySelector(`#${texts[i]}`).setAttribute("value",q.options[i]);
        document.querySelector(`#${id}`).setAttribute("color",["#FFC107","#8BC34A","#03A9F4"][i]);
      });
      sign.setAttribute("visible","false");
    }

    AFRAME.registerComponent('gaze-listener',{
      init:function(){
        this.el.addEventListener('click',()=>{
          const idx=boxes.indexOf(this.el.id);
          const boxEl=document.querySelector(`#${boxes[idx]}`);
          const boxPos=boxEl.getAttribute("position");
          if(idx===quiz[current].answer){
            score+=10;
            document.querySelector('#correctSound').components.sound.playSound();
            sign.setAttribute("src","#correctSign");
          } else {
            document.querySelector('#wrongSound').components.sound.playSound();
            sign.setAttribute("src","#wrongSign");
          }
          sign.setAttribute("position",{x:boxPos.x, y:boxPos.y+0.7, z:boxPos.z});
          sign.setAttribute("visible","true");
          document.querySelector('#score').setAttribute("text","value",`Score: ${score}`);
          setTimeout(()=>{
            current++;
            if(current<quiz.length){
              loadQuestion(current);
            } else {
              document.querySelector("#question").setAttribute("text","value","ðŸŽ‰ Quiz Finished!");
              boxes.forEach(b=>document.querySelector(`#${b}`).setAttribute("visible","false"));
              texts.forEach(t=>document.querySelector(`#${t}`).setAttribute("visible","false"));
              sign.setAttribute("visible","false");
              document.querySelector("#replay").setAttribute("visible","true");
              document.querySelector("#replayText").setAttribute("visible","true");
            }
          },1000);
        });
      }
    });

    AFRAME.registerComponent('gaze-listener-replay',{
      init:function(){
        this.el.addEventListener('click',()=>{
          score=0; current=0;
          document.querySelector('#score').setAttribute("text","value","Score: 0");
          document.querySelector("#replay").setAttribute("visible","false");
          document.querySelector("#replayText").setAttribute("visible","false");
          boxes.forEach(b=>document.querySelector(`#${b}`).setAttribute("visible","true"));
          texts.forEach(t=>document.querySelector(`#${t}`).setAttribute("visible","true"));
          loadQuestion(current);
        });
      }
    });

    boxes.forEach(id=>document.querySelector(`#${id}`).setAttribute('gaze-listener',''));
    document.querySelector('#replay').setAttribute('gaze-listener-replay','');

    loadQuestion(current);
  </script>
</a-scene>
</body>
</html>
