<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>VR Data Types Quiz</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/protyze/aframe-animation-path-component/dist/aframe-animation-path-component.min.js"></script>
  <style>body { margin:0; overflow:hidden; }</style>
</head>
<body>
<a-scene background="color: #000000">

  <!-- Assets -->
  <a-assets>
    <audio id="correctSound" src="https://cdn.jsdelivr.net/gh/aframevr/assets/click.mp3"></audio>
    <audio id="wrongSound" src="https://cdn.jsdelivr.net/gh/aframevr/assets/error.mp3"></audio>
    <audio id="forestSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_b526d9832e.mp3?filename=forest-birds-ambience-1080.mp3" preload="auto"></audio>

    <!-- Bird 3D model -->
    <a-asset-item id="birdModel" src="https://cdn.jsdelivr.net/gh/KhronosGroup/glTF-Sample-Models/2.0/Parrot/glTF/Parrot.gltf"></a-asset-item>
  </a-assets>

  <!-- Camera + gaze cursor -->
  <a-entity camera look-controls>
    <a-entity cursor="fuse: true; fuseTimeout: 1500"
              raycaster="objects: .clickable"
              position="0 0 -1"
              geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
              material="color: cyan; shader: flat">
    </a-entity>
  </a-entity>

  <!-- Forest background -->
  <a-sky src="https://cdn.pixabay.com/photo/2017/08/07/09/22/forest-2606214_1280.jpg"></a-sky>

  <!-- Background sound -->
  <a-entity sound="src: #forestSound; autoplay: true; loop: true; volume: 0.5"></a-entity>

  <!-- Question text -->
  <a-entity id="question" position="0 2 -4" text="value: ; align: center; width: 4; color: #FFF;"></a-entity>

  <!-- Options -->
  <a-box id="option1" class="clickable" depth="0.3" height="0.6" width="1" color="#FFC107">
    <a-text value="" align="center" position="0 0 0.2" color="#000"></a-text>
  </a-box>
  <a-box id="option2" class="clickable" depth="0.3" height="0.6" width="1" color="#8BC34A">
    <a-text value="" align="center" position="0 0 0.2" color="#000"></a-text>
  </a-box>
  <a-box id="option3" class="clickable" depth="0.3" height="0.6" width="1" color="#03A9F4">
    <a-text value="" align="center" position="0 0 0.2" color="#000"></a-text>
  </a-box>
  <a-box id="option4" class="clickable" depth="0.3" height="0.6" width="1" color="#E91E63">
    <a-text value="" align="center" position="0 0 0.2" color="#000"></a-text>
  </a-box>

  <!-- Score -->
  <a-entity id="score" position="0 3 -4" text="value: Score: 0; align: center; color: #FFF;"></a-entity>

  <!-- Replay button -->
  <a-box id="replay" class="clickable" position="0 -2 -3" depth="0.3" height="0.5" width="1.5" color="#FF9800" visible="false">
    <a-text value="Replay Quiz" align="center" position="0 0 0.2" color="#000"></a-text>
  </a-box>

  <!-- Moving bird models -->
  <a-entity gltf-model="#birdModel" scale="0.05 0.05 0.05"
            animation-path="path: -3 2 -5, 3 3 -6, -2 1.5 -4; dur: 12000; loop: true"></a-entity>
  <a-entity gltf-model="#birdModel" scale="0.05 0.05 0.05"
            animation-path="path: 2 2 -7, -3 1 -5, 3 3 -4; dur: 10000; loop: true"></a-entity>
  <a-entity gltf-model="#birdModel" scale="0.05 0.05 0.05"
            animation-path="path: 0 3 -6, 1 1 -4, -2 2 -5; dur: 15000; loop: true"></a-entity>

  <script>
    const quiz = [
      {q:"Which data type is 25?", options:["Text","Number","Color","Sound"], answer:1},
      {q:"Which data type is 'Blue'?", options:["Text","Number","Color","Video"], answer:2},
      {q:"Which data type is 'Hello'?", options:["Text","Number","Sound","Date"], answer:0},
      {q:"Which data type is 02:30 PM?", options:["Date","Time","Number","Text"], answer:1},
      {q:"Which data type is 12/09/2025?", options:["Date","Color","Sound","Text"], answer:0},
      {q:"Which data type is a YouTube clip?", options:["Text","Video","Number","Color"], answer:1},
      {q:"Which data type is music playing?", options:["Number","Sound","Text","Date"], answer:1}
    ];

    let current = 0;
    let score = 0;
    const boxes = ["option1","option2","option3","option4"];

    function loadQuestion(index){
      const q = quiz[index];
      document.querySelector("#question").setAttribute("text","value",q.q);
      boxes.forEach((id,i)=>{
        document.querySelector(`#${id} a-text`).setAttribute("value", q.options[i]);
        document.querySelector(`#${id}`).setAttribute("color",["#FFC107","#8BC34A","#03A9F4","#E91E63"][i]);
        document.querySelector(`#${id}`).setAttribute("visible","true");
        // Random positions
        const x = (Math.random()*4 - 2).toFixed(2);
        const y = (Math.random()*2 - 0.5).toFixed(2);
        const z = (-3 - Math.random()).toFixed(2);
        document.querySelector(`#${id}`).setAttribute("position", `${x} ${y} ${z}`);
      });
    }

    AFRAME.registerComponent('gaze-listener',{
      init: function(){
        this.el.addEventListener('click', ()=>{
          const idx = boxes.indexOf(this.el.id);
          if(idx === quiz[current].answer){
            score += 10;
            document.querySelector('#correctSound').components.sound.playSound();
            this.el.setAttribute("color","#4CAF50");
          } else {
            document.querySelector('#wrongSound').components.sound.playSound();
            this.el.setAttribute("color","#F44336");
          }
          document.querySelector('#score').setAttribute("text","value",`Score: ${score}`);
          setTimeout(()=>{
            current++;
            if(current < quiz.length){
              loadQuestion(current);
            } else {
              document.querySelector("#question").setAttribute("text","value","ðŸŽ‰ Quiz Finished!");
              boxes.forEach(b=>document.querySelector(`#${b}`).setAttribute("visible","false"));
              document.querySelector("#replay").setAttribute("visible","true");
            }
          },1500);
        });
      }
    });

    AFRAME.registerComponent('gaze-listener-replay',{
      init: function(){
        this.el.addEventListener('click', ()=>{
          score = 0;
          current = 0;
          document.querySelector('#score').setAttribute("text","value","Score: 0");
          document.querySelector("#replay").setAttribute("visible","false");
          loadQuestion(current);
        });
      }
    });

    boxes.forEach(id => document.querySelector(`#${id}`).setAttribute('gaze-listener',''));
    document.querySelector('#replay').setAttribute('gaze-listener-replay','');
    loadQuestion(current);
  </script>
</a-scene>
</body>
</html>
